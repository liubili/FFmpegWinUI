<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="FFmpegWinUI.Page.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:FFmpegWinUI.Page"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <ScrollViewer>
        <StackPanel Padding="24" Spacing="24">
            <!-- 标题 -->
            <TextBlock Text="软件设置"
                       Style="{StaticResource TitleTextBlockStyle}"/>

            <!-- FFmpeg配置区域 -->
            <Expander Header="FFmpeg 配置" IsExpanded="True">
                <StackPanel Spacing="16" Margin="12">
                    <!-- FFmpeg bin 路径输入和提示 -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="FFmpeg bin 路径" FontWeight="SemiBold"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0"
                                     x:Name="FfmpegPathBox"
                                     PlaceholderText="请输入FFmpeg的bin目录路径"/>
                            <Button Grid.Column="1"
                                    Content="浏览..."
                                    Margin="8,0,0,0"
                                    Click="OnSelectFfmpegPath"/>
                        </Grid>
                    </StackPanel>

                    <!-- 下载区域 -->
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <Button x:Name="DownloadFfmpegBtn"
                                    Style="{StaticResource AccentButtonStyle}"
                                    Click="OnDownloadFfmpeg">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE896;"/>
                                    <TextBlock Text="下载最新FFmpeg"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="WingetInstallBtn"
                                    Click="OnWingetInstall">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE719;"/>
                                    <TextBlock Text="通过 winget 安装"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="OpenFfmpegFolderBtn"
                                    Click="OnOpenFfmpegFolder"
                                    Visibility="Collapsed">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE838;"/>
                                    <TextBlock Text="打开目录"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>

                        <CheckBox x:Name="RegisterToPathCheckBox"
                                  Content="下载后添加到系统 PATH"
                                  IsChecked="True"/>

                        <!-- 进度显示 -->
                        <Grid x:Name="ProgressGrid" Visibility="Collapsed">
                            <ProgressBar x:Name="DownloadProgressBar"
                                         Height="4"
                                         Minimum="0"
                                         Maximum="100"/>
                        </Grid>

                        <!-- 状态信息 -->
                        <InfoBar x:Name="StatusInfoBar"
                                 IsOpen="False"
                                 Severity="Informational"
                                 Title="FFmpeg 状态"/>
                    </StackPanel>
                </StackPanel>
            </Expander>

            <!-- 应用设置区域 -->
            <Expander Header="应用设置" IsExpanded="True">
                <StackPanel Spacing="12" Margin="12">
                    <ToggleSwitch Header="启用硬件加速"
                                  OnContent="启用"
                                  OffContent="禁用"
                                  IsOn="True"/>

                    <ToggleSwitch Header="自动检查更新"
                                  OnContent="启用"
                                  OffContent="禁用"
                                  IsOn="True"/>

                    <TextBlock Text="并发任务数" FontWeight="SemiBold" Margin="0,8,0,0"/>
                    <NumberBox Minimum="1" Maximum="8" Value="2" SpinButtonPlacementMode="Inline"/>

                    <TextBlock Text="默认输出路径" FontWeight="SemiBold" Margin="0,8,0,0"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" PlaceholderText="与源文件相同"/>
                        <Button Grid.Column="1" Content="浏览..." Margin="8,0,0,0"/>
                    </Grid>
                </StackPanel>
            </Expander>

            <!-- 外观设置 -->
            <Expander Header="外观" IsExpanded="False">
                <StackPanel Spacing="12" Margin="12">
                    <TextBlock Text="应用主题" FontWeight="SemiBold"/>
                    <RadioButtons>
                        <RadioButton Content="跟随系统" IsChecked="True"/>
                        <RadioButton Content="浅色"/>
                        <RadioButton Content="深色"/>
                    </RadioButtons>
                </StackPanel>
            </Expander>

            <!-- 关于 -->
            <StackPanel Spacing="8">
                <TextBlock Text="关于 FFmpeg WinUI" FontWeight="SemiBold"/>
                <TextBlock Text="版本: 1.0.0"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                <TextBlock Text="从 VB 项目移植而来的 WinUI 3 版本"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</Page>
